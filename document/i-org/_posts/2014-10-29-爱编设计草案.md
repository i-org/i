---
layout: post
title: "爱编设计草案"
date: 2014-10-29 18:29:59 +0800
categories: 说明
tags: [爱编, 语言设计, 编程]
lastmod: 2018-06-29
--- 

![i-org-logo-min](/static/i-small.png)


## 爱编系统设定

状态含义：●完成 ■待测试 ◆被认领开发中 ★计划



## 语言设定 ##
基本核心要尽可能精简小巧，其他的功能以扩展提供，以减少维护成本，提高核心稳定度。不能像通链那样 大而全。

类似 c 和 lua的关系，c的稳健精简利于lua的扩展。


一个图形组合编辑器：方便快速编写
一个解析器/编译器：解析器用js实现，编译器目标是汇编。

### 全模块化 ###

核心不要有各种 算法和巧写，算法和写法技巧通过扩展获得。

也不要有关于运行环境的设定。

核心就一个关键内名和转码机制设计。

这样最方便学习，且可扩展性好，可面向未来。

一些抽象度高的编程语言常见的写法技巧，可用一个扩展模块实现，但不集成在核心里。

让核心高度稳定，精简。


巧写法 写的时候爽，维护的时候哭。


### 模块间无限竞争 ###

竞争：各个语言、方言版本，各个相同功能模块。

### 语法设定 ###

要求：
1. 方便手写
2. 兼容键盘

手写情况下，括号类型有两种比较容易识别：大括号`{}`和中括号`[]`，其他的都较容易混淆，比如： `()` `<>`，右括号和右尖号容易和 *7* 混淆。

但由于大括号会形状比较杂乱，弃用，全部用中括号。

手写时，大括号可以一笔完成，而中括号需要两笔，所以，一般更应该采用大括号`{}`！

`[]`用于表达宏？

标识符最好能简化到类似 html的三个 `< > &`。

严格精确使用各个函数。

设计 | 具体函数用法 | 实例


### 功能系统 ###

+ 首.尾系统
+ 类型设定系统：可选
+ 宏
+ 对象级抽象 系统（有必要么？）

+ 实时解析器
+ 内建编译器


## 语法设定 ##

TODO: 语法设定仍然需要完善
检验：如何原文表述自己


### 20180629更新内容

1. 确定使用中括号：大括号缺点是符号多了后，全文看起来很难看。
2. 形式：
[宏 宏内容] 宏 macro
[注 注释内容] 可选 注释、释、析 comment
[若 甲=1 乙=2] 可选 如果 假设 if else
[复 ] 可选 重复，循环 dolist
[行 ] 可选 列表 list
[阵 ] 可选 数组 array
[行.长 ] list.length
[设 ？变量名] set variable
[设 ！常量名] set constant

regular express 简选式
debug 追踪
format 版 排版



### 基本形式设定 ###

**成对标识**：成对标识方便代码结构显示和处理。
设定：全角大括号 `｛｝` `[]`

```
｛ &#65371;
｝ &#65373;
&  &#38; &amp;  这个半角
```

**前置标识**表达式：全部使用全角符号。设定：

```
｛操作 内容｝

｛<命令名>+<操作选定>+<操作目标>+<结果筛选参数>｝
｛<function>+<operation>+[target]+<option>｝
        
｛设函数  函数名 ｛甲参数 乙参数 &可选参数 &关键字式参数｝｛函数内容｝｝
```

+ 字符设定：
```
        英文字母：a b c d e f g h i j k l m n o p q r s t u v w s y z
        对应
        中文笔画：横竖撇奈 竖直弯勾
        ㇐ ㇑ ㇓ ㇏㇔ ㇕ ㇖ ㇗ ㇘ ㇙ ㇚ ㇛ ㇜
```

+ 命名机制：
实际上后台是以数字/二进制形式命名，前台使用的是符号语义化的语言。以数字名字作为爱编 标口（标准接口），比如：

```
英文xx版 == 中介版 ==  中文xx版
say == 001 == 说
defun == 002 == 设
```

为保证唯一性，可以把中介版变成 **固定长度**的 md5码：也就是所有的内名都是 md5码。一个对照表。
```
英文版——md5码——中文版

内名码设定：md5码+语言版+创建时间

```

应用的名位规则：以应用创建时间来作为起始，自动生成。


可以形象化：
car oxxxx
cdr xxxxo



+ 命名约定


## 注释设定

多行注释
`[注 注释内容]` 可选 注释、释、析 comment

单行末注释，同样

`[注 注释内容]`

参考
**注释方式**：成对符号，写的时候繁琐了点，但界限明显，而且每行不用再写。

```
“”  太常用
\*  *\
※   太复杂，写的麻烦，和现有键盘不兼容
;;   太常用，和现有
\
/
//
<!--- 注释 --->  符号和总代码不同
｛！-- 注释 --｝ 或者 {| 注释  |}
[! 注释内容] 优点是通用于各种语言。
```


## 代码示例

爱编 指定
+ 用语模板——用于适应各种编程习惯，无论怎么变，都能变成标准的
+ 编译模板——用于适应各种应用，比如有的对浮点精度要求高，可在此设定

解析器 基本函数

转码，运行，使用规则，运行机制，调用插件

前置标识 成对括号

代码示例：

```
｛！国别编号：黑传说版语法｝
｛
  ｛／／程序基本信息设定
    ｛／／程序基本信息｝ 
    ｛／／导入模块｝
    ｛／／导出模块｝
  ｝
  ｛／／程序正文 

     ｛设 天  ｛高，长，宽｝
        ｛曰 “天地玄黄”｝
        ｛× ｛× 高 ∞｝｛× 长 ∞｝｛× 宽 ∞｝｝
     ｝
  ｝
｝
```

调用
```
｛天 ｛10 20 30｝｝
> 天地玄黄
> ∞
```
条件：一个条件或多个条件都这样！不用分 if else cons when
```
｛当 ｛｛条件1｝ ｛对应程序1｝｝
    ｛｛条件2｝ ｛对应程序2｝｝
    ｛其他｝
｝
```
循环
```
｛循环 ｛参数名 递增｛范围 1 2｝｝｛循环内容｝｝

｛设 递增 ｛数｝ ｛＋ 数 1｝｝
｛设 参数名 数｝
```

# 内建操作符设定

下面可参考神编和scheme，尽可能精炼

## 元操作符： meta operators

| 中文版 | English version | 说明 |
| --- | --- | --- |
| 原样  |  quote |  |
| 比较  |  equal |  |
| 元否  |  atom |  |
| 取首  |  first |  |
| 取余  |  rest |  |
| 串联  |  construct |  |
| 假设  |  condition |  |

元操作符生成基本操作符

## 基本操作符 basic operators

| 中文版 | English version | 说明 |
| --- | --- | --- |
| 命名 |  label | 代码块级别 | 
| 标记 |  tag | 代码块内 |
| 跳转 | goto |  |
| 指定 |  let |  |

基本操作符生成其他内置函数和机制

## 常用操作符 begin operators

+ 设 defun
+ 重复 回 loop

## 数据类型：

+ 判断：真 无 假  booleans T nil F
+ 字符：  strings  字串
+ 数字:  numbers
+ 数列:  lists   ｛｝
+ :tuples
+ :closures
+ :continuations

+ 文件 streams

+ 函数： functions

+ 名讳 symbols

+ 错误信息： errors 提示 prompts


## 常用函数：

### 条件结构：

| 中文版 | English version | 说明 |
| --- | --- | --- |
| 若 | if |  |
| 与 | and |  |
| 或 | or |  |
| 非 | not |  |
| 当 | cond |  |

是否可以归为一个？
是否需要借鉴 promise？

### 流程控制

+ 标识
+ 必然运行
+ 然后 接下去干什么——包括跳转到、跳出


### 赋值
+ 设 set
+ 获取值 get-value


### 函数构建
+ 定义函数 defun
+ 省名函数 lambda
+ 局部赋值 let
+ 比较 =
+ 类型设定 type


### 提醒处理  error prompt 一般用于提示出错信息
+ 提示 prompt  （error放入此处）


### 数据操作：
+ 数据类型判断
+ 数据转换
+ 数据遍历
+ 数据提取


### 数据位置

- 位置获取  
- 倒转

第一个
第二个
第三个
第四个
最后一个
倒数第二


### 前置标识表达式操作
+ 构建 cons
+ 取首 first
+ 取余 rest
+ 判断是否为数列 consp ?cons


### 二进制操作

+ 进制转换 
+ 取位
+ 换位
+ 计算（加 减 乘 除等）
+ 比较


### 矢量 vector
+ 创建
+ 数据位置
+ 矢量否？ vector?

### 数学操作

| 符号 | 中文版 | English | 说明 |
| --- | --- | --- | --- |
| + | 加 | add |  |
| - | 减 | subtract |  |
| × | 乘 | * multiply |  |
| / | 除 | divide |  |
| > | 大于 | greater? |  |
| < | 小于 | less? |  |
| >= | 大于等于 | greater-than-or-equal-to? |  |
| <= | 小于等于 | less-than-or-equal-to? |  |
| 判断是否是数字 number? |  |  |  |

### 文件操作
+ 逐字读取 read-byte
+ 输出为文件
+ 打开文件 open
+ 关闭文件 close

### 时间操作
+ 获得时间 get-time

## 代码编写设定 ##

### 文件头部设定

**必须**：在源码文件开头声明设定所使用语言以及方言版本。

    ※ -*- coding: utf-8 il:zh-jobinson -*-
    -*- utf-8 i:zh:jobinson -*-

下面的格式好像更简洁。

各语言标识对应：

    中文：
    zh-jobinson  语言设计者黑传说常用的中文编程词汇
    zh-dao 　　  道教用语版
    zh-fo 　　   佛教用语版
    zh-wenyan    文言文版
    
    英文：
    en-jobinson 　　语言设计者黑传说常用的英文编程词汇
    en-commonlisp 　通链版词汇

设定创建时间：




### 对象级抽象 系统 ###

+ 抽象方法 defgeneric
+ 方法 defmethod
+ 抽象类 defclass


## 交互环境设定 ##


### 运行机制 ###

为提高交互环境的速度：交互中介格式使用 类似 capnproto？？？


后台变量名长度：固定。
- 变量名规则：为能统一全球所有语言的变量名，可设定变量名转换规则为 语言名+变量名？？？
- 长变量名处理：对于长的变量名，可散列化转换出固定位数


文件载入可根据设定的编码和方言类型，自动调用相应的方言 解析器。

头部指定方言环境：

+ i-zh-jobinson 表示使用的是 *爱编-中文-黑传说版* 的方言环境
+ i-en-jobinson 表示使用的是 *爱编-英文-黑传说版* 的方言环境
+ ……

默认至少两个编译方向：

+ 编译为js
+ 编译为本地二进制


### 交互环境用的基本操作符

| 中文版 | English version | 说明 |
| --- | --- | --- |
| 捕获 | catch |  |
| 抛出 | throw |  |
| 必运行 |  |  |
| 读 |   read |  |
| 写 |   write |  |
| 运行 | eval | 相对于cl的eval-when |


## 综合

使用的词汇：不能作为标识符

使用的符号：

使用的双符号：




